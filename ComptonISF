%ComptonISF -  incoherent scattering function
%Approximates x-ray scatter intensity for given /theta.
%theta = Scatter Angle
%E = incident photon energy
%Z = atomic number
function DCS = ComptonISF(theta, E)
%Constants
c = 299792458;                %Speed of light in a vacuum [m/s]
r_e = 2.8179403227E-15;       %Classical electron radius [m]
m_e = 9.1093821545E-31;       %Electron rest mass [kg]
h = 6.62607004E-34;           %Plancks constant [m^2*kg/s]

%Sub-functions
k = E/(m_e*c^2); 
Eco = E/(1+k*(1-cos(theta))); %scattered photon energy
x = abs(sin(theta/2)/(100*(h*c/E)));

%Z_26 Incoherent Scattering Factor (942)
p = [1.000000E+1 5.00000E-12
 1.000000E+2 5.00000E-10
 1.000000E+3 5.000000E-8
 1.000000E+4 5.000000E-6
 1.000000E+5 5.000000E-4
 5.000000E+5 1.250000E-2
 6.718700E+5 2.257046E-2
 7.890600E+5 3.113078E-2
 9.296900E+5 4.321617E-2
 1.000000E+6 5.000000E-2
 1.125000E+6 6.314710E-2
 1.500000E+6 1.109000E-1
 2.000000E+6 1.947000E-1
 2.500000E+6 2.995000E-1
 3.000000E+6 4.233000E-1
 3.500000E+6 5.637240E-1
 4.000000E+6 7.183000E-1
 4.500000E+6 8.845850E-1
 5.000000E+6 1.060000E+0
 5.500000E+6 1.241960E+0
 5.875000E+6 1.381440E+0
 6.437500E+6 1.593470E+0
 6.500000E+6 1.617060E+0
 7.000000E+6 1.806500E+0
 7.500000E+6 1.994700E+0
 8.250000E+6 2.273090E+0
 8.500000E+6 2.364290E+0
 9.000000E+6 2.544200E+0
 9.750000E+6 2.805890E+0
 1.000000E+7 2.891000E+0
 1.109400E+7 3.249700E+0
 1.187500E+7 3.494390E+0
 1.250000E+7 3.684100E+0
 1.437500E+7 4.228930E+0
 1.500000E+7 4.405000E+0
 1.750000E+7 5.096300E+0
 2.000000E+7 5.781000E+0
 2.250000E+7 6.463650E+0
 2.500000E+7 7.138100E+0
 2.750000E+7 7.795410E+0
 2.875000E+7 8.116620E+0
 3.000000E+7 8.432000E+0
 3.343800E+7 9.265570E+0
 3.437500E+7 9.485050E+0
 3.718800E+7 1.012300E+1
 4.000000E+7 1.073300E+1
 4.437500E+7 1.162630E+1
 4.500000E+7 1.174950E+1
 5.000000E+7 1.268700E+1
 5.750000E+7 1.395530E+1
 6.000000E+7 1.434300E+1
 6.750000E+7 1.539690E+1
 7.000000E+7 1.571600E+1
 7.750000E+7 1.657330E+1
 8.000000E+7 1.683100E+1
 8.750000E+7 1.752600E+1
 9.000000E+7 1.773700E+1
 1.000000E+8 1.848800E+1
 1.125000E+8 1.927920E+1
 1.187500E+8 1.963040E+1
 1.218800E+8 1.979650E+1
 1.250000E+8 1.995900E+1
 1.312500E+8 2.026710E+1
 1.406300E+8 2.069920E+1
 1.500000E+8 2.109700E+1
 1.589800E+8 2.144630E+1
 1.665000E+8 2.171700E+1
 1.748800E+8 2.199630E+1
 1.750000E+8 2.200010E+1
 1.838500E+8 2.227060E+1
 1.919300E+8 2.249680E+1
 2.000000E+8 2.270400E+1
 2.250000E+8 2.324050E+1
 2.281300E+8 2.329690E+1
 2.359400E+8 2.343220E+1
 2.429700E+8 2.354480E+1
 2.500000E+8 2.365000E+1
 2.562500E+8 2.373460E+1
 2.835900E+8 2.405640E+1
 2.918000E+8 2.413910E+1
 3.000000E+8 2.421600E+1
 3.062500E+8 2.426940E+1
 3.335900E+8 2.448350E+1
 3.418000E+8 2.454140E+1
 3.500000E+8 2.459800E+1
 3.589800E+8 2.465330E+1
 3.665000E+8 2.469860E+1
 3.712900E+8 2.472700E+1
 4.000000E+8 2.488700E+1
 4.125000E+8 2.494810E+1
 4.234400E+8 2.500020E+1
 4.425800E+8 2.508840E+1
 5.000000E+8 2.531000E+1
 5.625000E+8 2.549450E+1
 5.875000E+8 2.555540E+1
 6.000000E+8 2.558500E+1
 7.000000E+8 2.575500E+1
 7.625000E+8 2.582340E+1
 7.875000E+8 2.584530E+1
 8.000000E+8 2.585600E+1
 8.242200E+8 2.587120E+1
 8.461900E+8 2.588460E+1
 8.743900E+8 2.590140E+1
 9.057900E+8 2.591580E+1
 9.529000E+8 2.593280E+1
 1.000000E+9 2.594900E+1
 1.218800E+9 2.598170E+1
 1.289100E+9 2.598760E+1
 1.394500E+9 2.599200E+1
 1.473600E+9 2.599430E+1
 1.500000E+9 2.599500E+1
 1.562500E+9 2.599560E+1
 1.671900E+9 2.599650E+1
 1.753900E+9 2.599720E+1
 1.877000E+9 2.599810E+1
 2.000000E+9 2.599900E+1
 2.187500E+9 2.599910E+1
 2.445700E+9 2.599920E+1
 2.682600E+9 2.599930E+1
 2.972200E+9 2.599940E+1
 3.344000E+9 2.599960E+1
 3.935400E+9 2.599970E+1
 5.000000E+9 2.600000E+1
 8.000000E+9 2.600000E+1
 9.500000E+9 2.600000E+1
 1.00000E+10 2.600000E+1
 1.20500E+10 2.600000E+1
 1.41820E+10 2.600000E+1
 1.56500E+10 2.600000E+1
 1.86390E+10 2.600000E+1
 2.17050E+10 2.600000E+1
 2.41520E+10 2.600000E+1
 2.88920E+10 2.600000E+1
 3.54200E+10 2.600000E+1
 4.14090E+10 2.600000E+1
 4.87330E+10 2.600000E+1
 5.81320E+10 2.600000E+1
 7.30850E+10 2.600000E+1
 9.32710E+10 2.600000E+1
 1.00000E+11 2.600000E+1
 1.17140E+11 2.600000E+1
 1.55940E+11 2.600000E+1
 2.04410E+11 2.600000E+1
 2.99030E+11 2.600000E+1
 4.21500E+11 2.600000E+1
 7.29680E+11 2.600000E+1
 1.61310E+12 2.600000E+1
 4.52640E+12 2.600000E+1
 2.12750E+13 2.600000E+1
 1.00000E+14 2.600000E+1
 5.62340E+14 2.600000E+1
 7.49890E+15 2.600000E+1
 1.00000E+17 2.600000E+1];

%Interpolation
g=zeros(111, 1);
h=zeros(111, 1);
for i=1:111;
    g(i) = p(i, 1);
    h(i) = p(i, 2);
end
ISF = interp1(g, h, x, 'spline');

%Differential Cross Section
DCS = (r_e^2/2)*(Eco/E)^2*(Eco/E+E/Eco-sin(theta)^2)*ISF;
end
