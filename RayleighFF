%RayleighFF - Form Factor
%Aproximation of the x-ray scatter intensity for given /theta.
%theta = Scatter Angle
%E = incident photon energy
%Z = atomic number
function [DCS] = RayleighFF(theta, E)
%Constants
c = 299792458;        %Speed of light in a vacuum [m/s]
r_e = 2.8179403227E-15; %Classical electron radius [m]
h = 6.62607004E-34;      %Plancks constant [m^2*kg/s]

%Sub-functions
x = abs(sin(theta/2)/(100*(h*c/E))); % [1/cm]

%Z_26 Form Factor (941)
p = [0.0     2.600000E1
 1.000000E5 2.600000E1
 5.000000E5 2.598300E1
 6.718700E5 2.597360E1
 7.890600E5 2.596850E1
 9.296900E5 2.596330E1
 1.000000E6 2.596100E1
 1.125000E6 2.595380E1
 1.500000E6 2.593200E1
 2.000000E6 2.588000E1
 2.500000E6 2.581400E1
 3.000000E6 2.573500E1
 3.500000E6 2.564030E1
 4.000000E6 2.553800E1
 4.500000E6 2.542450E1
 5.000000E6 2.530200E1
 5.500000E6 2.516440E1
 5.875000E6 2.505620E1
 6.437500E6 2.488470E1
 6.500000E6 2.486550E1
 7.000000E6 2.470700E1
 7.500000E6 2.454130E1
 8.250000E6 2.428320E1
 8.500000E6 2.419750E1
 9.000000E6 2.402300E1
 9.750000E6 2.375450E1
 1.000000E7 2.366600E1
 1.109400E7 2.326340E1
 1.187500E7 2.296960E1
 1.250000E7 2.273600E1
 1.437500E7 2.203190E1
 1.500000E7 2.180300E1
 1.750000E7 2.091100E1
 2.000000E7 2.003300E1
 2.250000E7 1.917560E1
 2.500000E7 1.834000E1
 2.750000E7 1.752510E1
 2.875000E7 1.712370E1
 3.000000E7 1.672900E1
 3.343800E7 1.566760E1
 3.437500E7 1.538720E1
 3.718800E7 1.457530E1
 4.000000E7 1.380900E1
 4.437500E7 1.270830E1
 4.500000E7 1.256050E1
 5.000000E7 1.146800E1
 5.750000E7 1.010270E1
 6.000000E7 9.716500E0
 6.750000E7 8.740790E0
 7.000000E7 8.469700E0
 7.750000E7 7.793040E0
 8.000000E7 7.604200E0
 8.750000E7 7.126090E0
 9.000000E7 6.988900E0
 1.000000E8 6.515000E0
 1.125000E8 6.016100E0
 1.187500E8 5.784680E0
 1.218800E8 5.670980E0
 1.250000E8 5.558600E0
 1.312500E8 5.335490E0
 1.406300E8 5.006540E0
 1.500000E8 4.686600E0
 1.589800E8 4.388310E0
 1.665000E8 4.145230E0
 1.748800E8 3.882380E0
 1.750000E8 3.878700E0
 1.838500E8 3.610460E0
 1.919300E8 3.374690E0
 2.000000E8 3.148800E0
 2.250000E8 2.544630E0
 2.281300E8 2.483780E0
 2.359400E8 2.347910E0
 2.429700E8 2.244810E0
 2.500000E8 2.159400E0
 2.562500E8 2.097470E0
 2.835900E8 1.889890E0
 2.918000E8 1.826980E0
 3.000000E8 1.757800E0
 3.062500E8 1.700090E0
 3.335900E8 1.457540E0
 3.418000E8 1.401230E0
 3.500000E8 1.356200E0
 3.589800E8 1.320240E0
 3.665000E8 1.297870E0
 3.712900E8 1.286260E0
 4.000000E8 1.230400E0
 4.125000E8 1.202240E0
 4.234400E8 1.174730E0
 4.425800E8 1.123410E0
 5.000000E8 9.789000E-1
 5.625000E8 8.615970E-1
 5.875000E8 8.176330E-1
 6.000000E8 7.953000E-1
 7.000000E8 6.317000E-1
 7.625000E8 5.632150E-1
 7.875000E8 5.365960E-1
 8.000000E8 5.227000E-1
 8.242200E8 4.942570E-1
 8.461900E8 4.677090E-1
 8.743900E8 4.337560E-1
 9.057900E8 3.973550E-1
 9.529000E8 3.475930E-1
 1.000000E9 3.048000E-1
 1.218800E9 1.778870E-1
 1.289100E9 1.522840E-1
 1.394500E9 1.218140E-1
 1.473600E9 1.036070E-1
 1.500000E9 9.824100E-2
 1.562500E9 8.674500E-2
 1.671900E9 7.014820E-2
 1.753900E9 6.012230E-2
 1.877000E9 4.809480E-2
 2.000000E9 3.887300E-2
 2.187500E9 2.863800E-2
 2.445700E9 1.943980E-2
 2.682600E9 1.402670E-2
 2.972200E9 9.721200E-3
 3.344000E9 6.344220E-3
 3.935400E9 3.493300E-3
 5.000000E9 1.440300E-3
 8.000000E9 2.521200E-4
 9.500000E9 1.338190E-4
 1.00000E10 1.108700E-4
 1.20500E10 5.627380E-5
 1.41820E10 3.133480E-5
 1.56500E10 2.205920E-5
 1.86390E10 1.189760E-5
 2.17050E10 6.984430E-6
 2.41520E10 4.820820E-6
 2.88920E10 2.601670E-6
 3.54200E10 1.299990E-6
 4.14090E10 7.674530E-7
 4.87330E10 4.449520E-7
 5.81320E10 2.477230E-7
 7.30850E10 1.166370E-7
 9.32710E10 5.267320E-8
 1.00000E11 4.202700E-8
 1.17140E11 2.522290E-8
 1.55940E11 1.008880E-8
 2.04410E11 4.273620E-9
 2.99030E11 1.293630E-9
 4.21500E11 4.45147E-10
 7.29680E11 8.25676E-11
 1.61310E12 7.51834E-12
 4.52640E12 3.51828E-13
 2.12750E13 3.82888E-15
 1.00000E14 4.25890E-17
 5.62340E14 2.69377E-19
 7.49890E15 1.24664E-22
 1.00000E17 5.47220E-26];

%Interpolation
g=zeros(150, 1);
h=zeros(150, 1);
for i=1:150;
    g(i) = p(i, 1);
    h(i) = p(i, 2);
end
FF = interp1(g, h, x, 'spline');

%Differential Cross Section
DCS = 0.5*(r_e^2)*(1+((cos(theta))^2))*((FF)^2);
end
